'From Squeak4.3 of 22 December 2011 [latest update: #11860] on 22 July 2012 at 4:11:44 pm'!"Change Set:		PreferencesSaveFix-muDate:			22 July 2012Author:			Masashi UmezawaAvoid hanging-up when trying to save preferences. Note that this patch does not fix the real problem -- preferences are not serializable in Squeak 4.3."!!Preferences class methodsFor: 'personalization' stamp: 'mu 7/22/2012 13:32'!savePersonalPreferences	"Save the current list of Preference settings as the user's personal choices"	self		setParameter:#PersonalDictionaryOfPreferences		to: (DictionaryOfPreferences copy )! !!Preferences class methodsFor: 'personalization' stamp: 'mu 7/22/2012 13:31'!storePreferencesIn: aFileName 	| stream prefsSnapshot |	#(#Prevailing #PersonalPreferences )  do:[:ea | Parameters  removeKey:ea  ifAbsent:[]].	stream := ReferenceStream fileNamed: aFileName.	stream  nextPut:Parameters.	prefsSnapshot := DictionaryOfPreferences copy.	prefsSnapshot keysAndValuesDo: [:key :pref | prefsSnapshot at: key put: pref asPreference].	stream  nextPut: prefsSnapshot.	Smalltalk isMorphic 		 ifTrue:[stream nextPut:World fillStyle]		 ifFalse:[stream nextPut:DesktopColor].	stream close! !